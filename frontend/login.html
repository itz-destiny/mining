<!doctype html>
<html>
<head><meta charset="utf-8"><title>Login - Mining PWA</title></head>
<body>
  <h1>Login / Register</h1>
  <div>
    <h2>Register</h2>
    <form id="regForm">
      <input id="regUser" placeholder="username"><br>
      <input id="regPass" placeholder="password" type="password"><br>
      <button type="submit">Register</button>
    </form>
  </div>
  <div>
    <h2>Login</h2>
    <form id="loginForm">
      <input id="user" placeholder="username"><br>
      <input id="pass" placeholder="password" type="password"><br>
      <button type="submit">Login</button>
    </form>
  </div>
<script>
document.getElementById('regForm').onsubmit = async (e) => {
  e.preventDefault();
  const u = document.getElementById('regUser').value, p = document.getElementById('regPass').value;
  const r = await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});
  const j = await r.json(); alert(JSON.stringify(j)); if (j.ok) { localStorage.setItem('token', j.token); window.location='/dashboard.html'; }
};
document.getElementById('loginForm').onsubmit = async (e) => {
  e.preventDefault();
  const u = document.getElementById('user').value, p = document.getElementById('pass').value;
  const r = await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});
  const j = await r.json(); alert(JSON.stringify(j)); if (j.ok) { localStorage.setItem('token', j.token); window.location='/dashboard.html'; }
};
</script>
</body>
</html>
